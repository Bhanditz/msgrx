(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{202:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},216:function(e,t,a){e.exports=a(493)},221:function(e,t,a){},223:function(e,t,a){},263:function(e,t,a){},302:function(e,t){},304:function(e,t){},336:function(e,t){},493:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(9),i=a.n(o),c=(a(221),a(71)),l=a(72),s=a(75),d=a(73),p=a(76),u=(a(202),a(223),a(102),a(34)),h=(a(228),a(212)),f=(a(492),a(142)),m=(a(247),a(61)),g=(a(250),a(10)),y=a(214),_=(a(253),a(21)),v=(a(103),a(99)),b=a(101),E=a(143),w=(a(494),a(77)),k=(a(260),a(100)),j=(a(263),a(62)),x=a.n(j),S=k.a.Header,O=k.a.Content,I=w.a.Item,C=r.a.createContext(),P=w.a.create()(function(e){var t=e.form,a=(e.index,Object(E.a)(e,["form","index"]));return r.a.createElement(C.Provider,{value:t},r.a.createElement("tr",a))}),R={blockchain:"eos",protocol:"https",host:"api-kylin.eosasia.one",port:"",chainId:"5fff1dae8dc8e2fc4d5b23b2c7665c97f9e9d8edf2b6485a86ba311c25639191"},N={blockchain:"eos",protocol:"https",host:"nodes.get-scatter.com",port:"443",chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906"},F="trustbetinfo";Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e};var L=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={editing:!1},a.toggleEdit=function(){var e=!a.state.editing;a.setState({editing:e},function(){e&&a.input.focus()})},a.handleClickOutside=function(e){a.state.editing&&a.cell!==e.target&&!a.cell.contains(e.target)&&a.save()},a.save=function(){var e=a.props,t=e.record,n=e.handleSave;a.form.validateFields(function(e,r){e||(a.toggleEdit(),n(Object(b.a)({},t,r)))})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.editable&&document.addEventListener("click",this.handleClickOutside,!0)}},{key:"componentWillUnmount",value:function(){this.props.editable&&document.removeEventListener("click",this.handleClickOutside,!0)}},{key:"render",value:function(){var e=this,t=this.state.editing,a=this.props,n=a.editable,o=a.dataIndex,i=a.title,c=a.record,l=(a.index,a.handleSave,Object(E.a)(a,["editable","dataIndex","title","record","index","handleSave"]));return r.a.createElement("td",Object.assign({ref:function(t){return e.cell=t}},l),n?r.a.createElement(C.Consumer,null,function(a){return e.form=a,t?r.a.createElement(I,{style:{margin:0}},a.getFieldDecorator(o,{rules:[{required:!0,message:"".concat(i," is required.")}],initialValue:c[o]})(r.a.createElement(v.a,{ref:function(t){return e.input=t},onPressEnter:e.save,style:{width:"60%",textAlign:"center"}}))):r.a.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:e.toggleEdit},l.children)}):l.children)}}]),t}(r.a.Component),M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).resetState=function(){a.pay_json=[],a.pay_memo="",a.trx_option=null,a.partner_old={},a.setState({is_login:!1,login_account:"Login",partners:[],records:[],loading_partners:!0,loading_records:!0})},a.updPayJson=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.pid,r=e.day;if(a.pay_json[n]){var o=a.pay_json[n].indexOf(r);if(o<0){if(t){var i=a.pay_json[n];a.pay_json[n]=i.concat(r)}}else t||a.pay_json[n].splice(o,1)}else t&&(a.pay_json[n]=[r]);console.log("update => pay_json: ",a.pay_json)},a.hasErrors=function(e){return Object.keys(e).some(function(t){return e[t]})},a.addPartner=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){e||(a.state.is_login&&F===a.state.login_account?a.scatter.eos(a.network,x.a,{}).contract(F).then(function(e){e.addpart(t.partName,t.partRate,a.trx_option).then(function(e){a.getPartners(),_.a.success("\u6dfb\u52a0\u6210\u529f~")}).catch(function(e){_.a.error("\u6dfb\u52a0\u5931\u8d25!")})}).catch(function(e){console.error(e)}):_.a.error("\u8bf7\u767b\u5f55".concat(F,"\u8d26\u53f7\u8fdb\u884c\u8be5\u64cd\u4f5c\uff01")))})},a.updPartner=function(e){if(a.state.is_login&&F===a.state.login_account)if((e.pid||e.pid)>=0&&(e.rate||e.rate)>=0&&e.partner&&(a.partner_old.pid||a.partner_old.pid>=0)&&(a.partner_old.rate||a.partner_old.rate>=0)&&a.partner_old.partner)if(e.pid===a.partner_old.pid)if(e.rate!==a.partner_old.rate||e.partner!==a.partner_old.partner){var t=e.pid,n=e.rate,r=e.partner,o=a.partner_old.rate,i=a.partner_old.partner;a.scatter.eos(a.network,x.a,{}).contract(F).then(function(e){e.updpart(t,i,r,o,n,a.trx_option).then(function(e){a.getPartners(),_.a.success("\u66f4\u65b0\u6210\u529f~")}).catch(function(e){_.a.error("\u66f4\u65b0\u5931\u8d25!")})}).catch(function(e){console.error(e)})}else _.a.info("\u6ca1\u6709\u9700\u8981\u66f4\u65b0\u7684~");else _.a.warning("\u8bf7\u70b9\u51fb\u521a\u624d\u4fee\u6539\u90a3\u4e00\u884c\u7684\u66f4\u65b0\uff01");else _.a.warning("\u8bf7\u5148\u4fee\u6539\u8d26\u53f7\u6216\u8fd4\u73b0\u7387\uff01");else _.a.error("\u8bf7\u767b\u5f55".concat(F,"\u8d26\u53f7\u8fdb\u884c\u8be5\u64cd\u4f5c\uff01"))},a.pay=function(){if(a.state.is_login&&F===a.state.login_account){a.pay_memo="";for(var e=a.pay_json.length,t=0;t<e;t++)a.pay_json[t]&&a.pay_json[t].length>0&&(a.pay_memo.length>0&&(a.pay_memo+=";"),a.pay_memo=a.pay_memo+t+":"+a.pay_json[t].join(":"));if(a.pay_memo.length>0)a.scatter.eos(a.network,x.a,{}).contract(F).then(function(e){e.pay(a.pay_memo,a.trx_option).then(function(e){a.pay_json=[],a.pay_memo="",a.getPartners(),_.a.success("\u7ed3\u7b97\u6210\u529f~")}).catch(function(e){_.a.error("\u7ed3\u7b97\u5931\u8d25\uff01")})}).catch(function(e){console.error(e)});else _.a.warning("\u8bf7\u52fe\u9009\u8981\u7ed3\u7b97\u7684\u9879!")}else _.a.error("\u8bf7\u767b\u5f55".concat(F,"\u8d26\u53f7\u8fdb\u884c\u8be5\u64cd\u4f5c\uff01"))},a.getPartners=function(){a.eosjs.getTableRows({json:!0,code:F,scope:F,table:"parts"}).then(function(e){e.rows&&e.rows.length>0&&(a.setState({partners:e.rows}),a.getRecords(e.rows,0)),a.setState({loading_partners:!1})}).catch(function(e){console.error(e),a.setState({loading_partners:!1})})},a.getRecords=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a.eosjs.getTableRows({json:!0,code:F,scope:e[t].pid,table:"records"}).then(function(n){if(t)a.setState(function(e){var t=e.records;return t.push(n.rows),{records:t}});else{var r=[];r.push(n.rows),a.setState({records:r})}++t<e.length?a.getRecords(e,t):a.setState({loading_records:!1})}).catch(function(e){console.error(e),a.setState({loading_records:!1})})},a.accountLoginLogout=function(){null!==a.scatter?a.state.is_login&&a.scatter&&a.scatter.identity?a.scatter.forgetIdentity().then(function(){a.setState({is_login:!1}),a.setState({login_account:"Login"})}):a.state.is_login||!a.scatter||a.scatter.identity||a.scatter.getIdentity({accounts:[a.network]}).then(function(){var e=a.scatter.identity.accounts.find(function(e){return"eos"===e.blockchain});e.name!==F&&_.a.warning("\u8be5\u8d26\u53f7\u4e0d\u662f\u7ba1\u7406\u5458\u8d26\u53f7"),a.trx_option={authorization:["".concat(e.name,"@").concat(e.authority)]},a.setState({login_account:e.name}),a.setState({is_login:!0})}):_.a.info("\u8bf7\u5148\u5b89\u88c5\u6216\u89e3\u9501Scatter")},a.switchNet=function(e){if(a.network=e?N:R,a.eosjs=x()({httpEndpoint:"".concat(a.network.protocol,"://").concat(a.network.host,":").concat(a.network.port),chainId:a.network.chainId}),a.resetState(),a.getPartners(),a.scatter&&a.scatter.identity){var t=a.scatter.identity.accounts.find(function(e){return"eos"===e.blockchain});t.name!==F&&_.a.warning("\u8be5\u8d26\u53f7\u4e0d\u662f\u7ba1\u7406\u5458\u8d26\u53f7"),a.trx_option={authorization:["".concat(t.name,"@").concat(t.authority)]},a.setState({login_account:t.name}),a.setState({is_login:!0})}},a.handleSave=function(e){delete e.key;var t=Object(y.a)(a.state.partners),n=t.findIndex(function(t){return e.pid===t.pid}),r=t[n];a.partner_old.pid||a.partner_old.pid>=0?a.partner_old.pid!==r.pid&&(a.partner_old=r):a.partner_old=r,t.splice(n,1,Object(b.a)({},r,e)),a.setState({partners:t})},a.init=function(){a.eosjs=x()({httpEndpoint:"".concat(a.network.protocol,"://").concat(a.network.host,":").concat(a.network.port),chainId:a.network.chainId}),document.addEventListener("scatterLoaded",function(e){a.scatter=window.scatter,window.scatter=null}),a.getPartners()},a.state={is_login:!1,login_account:"Login",partners:[],records:[],loading_partners:!0,loading_records:!0},a.pay_json=[],a.pay_memo="",a.trx_option=null,a.partner_old={},a.network=N,a.today=Math.floor(Date.now()/1e3/86400),a.columns_parts=[{title:"ID",dataIndex:"pid",key:"pid",align:"center"},{title:r.a.createElement("span",null,"\u8d26\u53f7 ",r.a.createElement(m.a,{placement:"top",title:"\u70b9\u51fb\u8d26\u53f7\u53ef\u4fee\u6539"},r.a.createElement(g.a,{type:"info-circle"}))),dataIndex:"partner",key:"partner",align:"center",editable:!0},{title:r.a.createElement("span",null,"\u8fd4\u73b0\u7387(\u4e07\u5206\u4e4b) ",r.a.createElement(m.a,{placement:"top",title:"\u70b9\u51fb\u8fd4\u73b0\u7387\u53ef\u4fee\u6539"},r.a.createElement(g.a,{type:"info-circle"}))),dataIndex:"rate",key:"rate",align:"center",editable:!0},{title:r.a.createElement("span",null,"\u64cd\u4f5c ",r.a.createElement(m.a,{placement:"top",title:"\u4fee\u6539\u8d26\u53f7\u6216\u8fd4\u73b0\u7387\u540e\u8fdb\u884c\u66f4\u65b0"},r.a.createElement(g.a,{type:"info-circle"}))),dataIndex:"operation",key:"operation",align:"center",render:function(e,t){return r.a.createElement("a",{href:"javascript:;",onClick:function(){a.updPartner(t)}},"\u66f4\u65b0")}}],a.recordsSelection={onSelect:function(e,t,n){t&&e.day===a.today?_.a.warning("\u4e0d\u80fd\u7ed3\u7b97\u5f53\u5929\u7684"):a.updPayJson(e,t)},onSelectAll:function(e,t,n){var r;if(e){r=t;for(var o=0;o<r.length;o++)r[o].day===a.today&&(_.a.warning("\u4e0d\u80fd\u7ed3\u7b97\u5f53\u5929\u7684"),r.splice(o,1))}else r=n;var i=!0,c=!1,l=void 0;try{for(var s,d=r[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var p=s.value;a.updPayJson(p,e)}}catch(u){c=!0,l=u}finally{try{i||null==d.return||d.return()}finally{if(c)throw l}}},getCheckboxProps:function(e){var t={disabled:!1};return e.day===a.today&&(t.disabled=!0),t}},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=this.state.partners,n=0;n<a.length;n++)t.push({key:n,pid:a[n].pid,partner:a[n].partner,rate:a[n].rate});var o=this.props.form,i=o.getFieldDecorator,c=o.getFieldsError,l=o.getFieldError,s=o.isFieldTouched,d=s("partName")&&l("partName"),p=s("partRate")&&l("partRate"),m={body:{row:P,cell:L}},y=this.columns_parts.map(function(t){return t.editable?Object(b.a)({},t,{onCell:function(a){return{record:a,editable:t.editable,dataIndex:t.dataIndex,title:t.title,handleSave:e.handleSave}}}):t});return r.a.createElement("div",null,r.a.createElement(k.a,{className:"layout"},r.a.createElement(S,{style:{position:"fixed",zIndex:1,width:"100%"}},r.a.createElement("div",{className:"header-box"},r.a.createElement(h.a,{className:"main-kylin",checkedChildren:"\u4e3b\u7f51",unCheckedChildren:"\u9e92\u9e9f",defaultChecked:!0,onChange:this.switchNet}),r.a.createElement("a",{href:"javascript:;",onClick:this.pay,className:"pay"},r.a.createElement("span",null,r.a.createElement(g.a,{type:"pay-circle"})," \u7ed3\u7b97")),r.a.createElement("a",{href:"javascript:;",onClick:this.accountLoginLogout,className:"login-logout"},!0===this.state.is_login?r.a.createElement("span",null,r.a.createElement(g.a,{type:"user"})," ",this.state.login_account):r.a.createElement("span",null,r.a.createElement(g.a,{type:"login"})," ",this.state.login_account)))),r.a.createElement(O,null,r.a.createElement("div",{className:"add-partner"},r.a.createElement(w.a,{layout:"inline",onSubmit:this.addPartner},r.a.createElement(I,{validateStatus:d?"error":"",help:d||""},i("partName",{rules:[{required:!0,message:"Please input a partner name!"}]})(r.a.createElement(v.a,{prefix:r.a.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),type:"text",placeholder:"\u8d26\u53f7"}))),r.a.createElement(I,{validateStatus:p?"error":"",help:p||""},i("partRate",{rules:[{required:!0,message:"Please input a return rate!"}]})(r.a.createElement(v.a,{prefix:r.a.createElement(g.a,{type:"calculator",style:{color:"rgba(0,0,0,.25)"}}),type:"number",placeholder:"\u8fd4\u73b0\u7387"}))),r.a.createElement(I,null,r.a.createElement(u.a,{type:"primary",htmlType:"submit",disabled:this.hasErrors(c())},"\u6dfb\u52a0\u4ee3\u7406")))),r.a.createElement(f.a,{components:m,columns:y,dataSource:t,expandedRowRender:function(t){for(var a=[],n=t.pid,o=e.state.records[n],i=0;o&&i<o.length;i++)a.push({key:i,pid:n,day:o[i].day,daytime:new Date(86400*o[i].day*1e3).Format("yyyy/MM/dd"),quantity:o[i].quantity});return r.a.createElement(f.a,{columns:[{title:"\u65e5\u671f",dataIndex:"daytime",key:"daytime",align:"center"},{title:"\u91d1\u989d(EOS)",dataIndex:"quantity",key:"quantity",align:"center"}],dataSource:a,rowSelection:e.recordsSelection,pagination:!1,loading:e.state.loading_records})},pagination:!1,loading:this.state.loading_partners,style:{width:"720px",margin:"30px auto"}}))))}},{key:"componentDidMount",value:function(){this.props.form.validateFields(),this.init()}}]),t}(n.Component),D=w.a.create()(M),q=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(D,null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[216,2,1]]]);
//# sourceMappingURL=main.3b328e66.chunk.js.map